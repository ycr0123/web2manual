---
title: "Claude Code 동작 원리"
description: "Claude Code가 코드베이스를 분석하고 작업을 수행하는 내부 메커니즘을 이해합니다."
trackId: "beginner"
lessonId: "how-it-works"
difficulty: "beginner"
estimatedMinutes: 30
order: 4
objectives:
  - "Claude Code의 컨텍스트 윈도우 개념 이해"
  - "파일 읽기 및 코드 분석 과정 파악"
  - "안전한 실행 모델 이해"
sourceDocs:
  - "1.4-how-claude-code-works.md"
tags:
  - "동작원리"
  - "컨텍스트"
  - "보안"
quiz:
  passingScore: 70
  questions:
    - id: "q1"
      question: "Claude Code가 코드베이스를 이해하는 주된 방법은 무엇인가요?"
      type: "multiple-choice"
      options:
        - id: "a"
          text: "모든 파일을 한 번에 메모리에 로드"
        - id: "b"
          text: "필요한 파일만 선택적으로 읽어 컨텍스트 윈도우에 포함"
        - id: "c"
          text: "별도의 데이터베이스에 코드를 인덱싱"
        - id: "d"
          text: "코드를 실행하여 결과를 분석"
      correctOptionId: "b"
      explanation: "Claude Code는 컨텍스트 윈도우(200K 토큰)를 사용하여 필요한 파일만 선택적으로 읽습니다. 모든 파일을 동시에 메모리에 올리지 않고, 작업과 관련된 파일들을 동적으로 읽어옵니다."
    - id: "q2"
      question: "Claude Code가 파일을 수정하기 전에 반드시 하는 것은 무엇인가요?"
      type: "multiple-choice"
      options:
        - id: "a"
          text: "자동으로 백업 파일 생성"
        - id: "b"
          text: "파일을 읽기 전용으로 변경"
        - id: "c"
          text: "사용자에게 변경사항을 보여주고 확인 요청"
        - id: "d"
          text: "Git 커밋 자동 생성"
      correctOptionId: "c"
      explanation: "Claude Code는 안전성을 위해 파일을 수정하기 전에 어떤 변경사항을 적용할 것인지 사용자에게 보여주고 확인을 요청합니다. 이를 통해 원치 않는 변경을 방지합니다."
---

## Claude Code의 아키텍처

Claude Code가 어떻게 작동하는지 이해하면 더 효과적으로 활용할 수 있습니다.

### 컨텍스트 윈도우

Claude Code의 핵심은 **컨텍스트 윈도우**입니다. Claude Code는 한 번에 최대 **200,000 토큰**(약 150,000 단어)의 정보를 처리할 수 있습니다.

<Callout type="note">
200K 토큰은 평균적인 크기의 코드베이스 전체를 담기에 충분한 용량입니다. 하지만 매우 큰 프로젝트에서는 Claude Code가 관련 파일을 선택적으로 읽습니다.
</Callout>

컨텍스트 윈도우에 포함되는 것들:

1. **CLAUDE.md 파일**: 프로젝트 지시사항 및 규칙
2. **대화 내역**: 현재 세션의 모든 대화
3. **읽은 파일들**: 작업 중 읽은 파일들의 내용
4. **명령 실행 결과**: 실행한 명령의 출력값

### 도구(Tool) 시스템

Claude Code는 여러 도구를 사용하여 작업을 수행합니다:

| 도구 | 기능 |
|------|------|
| `Read` | 파일 내용 읽기 |
| `Write` | 새 파일 생성 |
| `Edit` | 기존 파일 수정 |
| `Bash` | 터미널 명령 실행 |
| `Glob` | 파일 패턴 검색 |
| `Grep` | 텍스트 검색 |
| `Task` | 서브에이전트 실행 |

## 코드 분석 과정

Claude Code가 코드를 분석하는 일반적인 과정입니다:

### 1단계: 구조 파악

<CLIExample
  command="claude '이 프로젝트의 전체 구조를 분석해줘'"
  description="Claude Code가 디렉토리 구조를 탐색하고 주요 파일을 파악합니다."
/>

Claude Code는 먼저 다음을 확인합니다:
- 디렉토리 구조 탐색 (`Glob` 도구)
- `package.json`, `requirements.txt` 등 의존성 파일
- 주요 진입점 파일 (`index.js`, `main.py` 등)
- CLAUDE.md 파일

### 2단계: 관련 파일 선택

요청에 따라 필요한 파일만 선택적으로 읽습니다. 예를 들어 "사용자 인증 버그를 수정해줘"라는 요청이 오면:

1. 인증 관련 파일 검색 (`grep`, `glob`)
2. `auth.js`, `middleware/auth.ts` 등 관련 파일 읽기
3. 설정 파일 확인 (`.env.example` 등)
4. 테스트 파일 확인

### 3단계: 변경사항 계획

작업 계획을 세우고 사용자에게 확인을 요청합니다:

```
변경사항을 적용하기 전에 검토해주세요:

1. auth/middleware.ts 수정:
   - JWT 토큰 만료 처리 로직 추가
   - 오류 메시지 명확화

2. tests/auth.test.ts 수정:
   - 만료 토큰 테스트 케이스 추가

계속 진행할까요? (y/n)
```

### 4단계: 실행 및 검증

승인 후 변경사항을 적용하고, 테스트를 실행하여 결과를 확인합니다.

## 안전한 실행 모델

Claude Code는 여러 가지 안전장치를 가지고 있습니다.

### 권한 시스템

Claude Code는 세 가지 유형의 작업에 대해 다른 권한 수준을 적용합니다:

**자동 허용 (Auto-allow):**
- 파일 읽기
- 디렉토리 탐색
- 텍스트 검색

**확인 요청 (Ask before):**
- 파일 생성/수정
- 파일 삭제
- 명령 실행 (빌드, 테스트 등)

**항상 거부 (Always deny):**
- 현재 디렉토리 외부의 파일 수정
- 시스템 파일 접근
- 네트워크 요청 (별도 설정 시 허용 가능)

<Callout type="warning">
Claude Code는 현재 작업 디렉토리와 하위 디렉토리에서만 작업합니다. 이는 의도치 않은 시스템 파일 수정을 방지하는 중요한 보안 기능입니다.
</Callout>

### 변경사항 프리뷰

파일을 수정하기 전에 변경사항의 diff를 보여줍니다:

```diff
--- auth/middleware.ts (before)
+++ auth/middleware.ts (after)
@@ -15,6 +15,12 @@
 export function verifyToken(token: string) {
   try {
     const decoded = jwt.verify(token, process.env.JWT_SECRET);
+
+    // 토큰 만료 시간 확인
+    if (decoded.exp < Date.now() / 1000) {
+      throw new Error('Token has expired');
+    }
+
     return decoded;
   } catch (error) {
```

## 세션과 컨텍스트 관리

### 세션 지속성

Claude Code 세션 내에서는 모든 컨텍스트가 유지됩니다:
- 이전 대화 내용 참조 가능
- 읽은 파일들의 내용 기억
- 수행한 작업 이력 유지

### 컨텍스트 초기화

긴 작업 후 컨텍스트가 가득 찼을 때:

<CLIExample
  command="/clear"
  description="현재 세션의 컨텍스트를 초기화합니다. CLAUDE.md는 자동으로 다시 로드됩니다."
/>

<Callout type="tip">
`/clear` 명령어를 사용해도 CLAUDE.md 파일은 항상 자동으로 다시 로드됩니다. 프로젝트 컨텍스트는 유지되면서 대화 내역만 초기화됩니다.
</Callout>

<Collapsible title="토큰 절약 전략">
효율적인 토큰 사용을 위한 팁:

1. **CLAUDE.md에 핵심 정보 집중**: 자주 참조할 정보는 CLAUDE.md에 정리하세요
2. **작업 단위를 작게**: 한 번에 너무 많은 변경을 요청하지 마세요
3. **/clear 적극 활용**: 한 작업이 완료되면 컨텍스트를 초기화하세요
4. **구체적인 요청**: 모호한 요청은 많은 파일 탐색을 유발합니다
</Collapsible>
