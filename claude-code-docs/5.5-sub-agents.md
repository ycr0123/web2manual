---
title: "Create custom subagents"
titleKo: "커스텀 서브에이전트 만들기"
description: "Create and use specialized AI subagents in Claude Code for task-specific workflows."
descriptionKo: "태스크 특화 워크플로우를 위한 전문화된 AI 서브에이전트를 만들고 사용합니다."
source: https://code.claude.com/docs/en/sub-agents.md
fetched: 2026-02-18
section: 6.7
---

# 커스텀 서브에이전트 만들기

> 태스크 특화 워크플로우와 향상된 컨텍스트 관리를 위해 Claude Code에서 전문화된 AI 서브에이전트를 만들고 사용합니다.

서브에이전트는 특정 유형의 작업을 처리하는 특화된 AI 어시스턴트입니다. 각 서브에이전트는 자체 컨텍스트 창에서 커스텀 시스템 프롬프트, 특정 도구 접근, 독립적인 권한으로 실행됩니다. Claude가 서브에이전트의 설명과 일치하는 작업을 만나면 해당 서브에이전트에게 위임하고, 서브에이전트가 독립적으로 작업하여 결과를 반환합니다.

> 여러 에이전트가 병렬로 작업하고 서로 통신해야 하는 경우, 에이전트 팀을 참조하세요. 서브에이전트는 단일 세션 내에서 작업하며, 에이전트 팀은 별도의 세션 간에 조율합니다.

서브에이전트는 다음과 같은 목적에 도움이 됩니다:

* **컨텍스트 보존** - 탐색 및 구현을 메인 대화에서 분리하여 유지
* **제약 적용** - 서브에이전트가 사용할 수 있는 도구를 제한
* **구성 재사용** - 사용자 수준 서브에이전트로 프로젝트 전체에서 재사용
* **동작 특화** - 특정 도메인을 위한 집중된 시스템 프롬프트
* **비용 제어** - Haiku와 같은 더 빠르고 저렴한 모델로 작업 라우팅

## 내장 서브에이전트

Claude Code에는 Claude가 적절할 때 자동으로 사용하는 내장 서브에이전트가 포함되어 있습니다.

### Explore

코드베이스 검색 및 분석에 최적화된 빠른 읽기 전용 에이전트입니다.

* **모델**: Haiku (빠름, 낮은 지연 시간)
* **도구**: 읽기 전용 도구 (Write 및 Edit 도구에 대한 접근 거부됨)
* **목적**: 파일 검색, 코드 검색, 코드베이스 탐색

### Plan

플랜 모드 중 계획을 제시하기 전에 컨텍스트를 수집하는 데 사용되는 리서치 에이전트입니다.

* **모델**: 메인 대화에서 상속
* **도구**: 읽기 전용 도구 (Write 및 Edit 도구에 대한 접근 거부됨)
* **목적**: 계획을 위한 코드베이스 리서치

### General-purpose

탐색과 동작을 모두 필요로 하는 복잡한 다단계 작업을 위한 유능한 에이전트입니다.

* **모델**: 메인 대화에서 상속
* **도구**: 모든 도구
* **목적**: 복잡한 리서치, 다단계 작업, 코드 수정

### 기타 에이전트

| 에이전트 | 모델 | Claude가 사용하는 경우 |
| :--- | :--- | :--- |
| Bash | 상속 | 별도의 컨텍스트에서 터미널 명령 실행 |
| statusline-setup | Sonnet | `/statusline`을 실행하여 상태줄을 구성할 때 |
| Claude Code Guide | Haiku | Claude Code 기능에 대한 질문을 할 때 |

## 빠른 시작: 첫 번째 서브에이전트 만들기

**1단계: 서브에이전트 인터페이스 열기**

Claude Code에서 실행합니다:

```
/agents
```

**2단계: 새 사용자 수준 에이전트 만들기**

**Create new agent**를 선택한 다음 **User-level**을 선택합니다. 이렇게 하면 서브에이전트가 `~/.claude/agents/`에 저장되어 모든 프로젝트에서 사용 가능합니다.

**3단계: Claude로 생성**

**Generate with Claude**를 선택합니다. 프롬프트가 표시되면 서브에이전트를 설명합니다:

```
A code improvement agent that scans files and suggests improvements
for readability, performance, and best practices. It should explain
each issue, show the current code, and provide an improved version.
```

**4단계: 도구 선택**

읽기 전용 리뷰어의 경우 **Read-only tools** 외의 모든 항목을 선택 해제합니다.

**5단계: 모델 선택**

서브에이전트가 사용할 모델을 선택합니다. 이 예시 에이전트의 경우 코드 패턴 분석을 위한 기능과 속도의 균형을 맞추는 **Sonnet**을 선택합니다.

**6단계: 색상 선택**

서브에이전트의 배경 색상을 선택합니다. 이렇게 하면 UI에서 어떤 서브에이전트가 실행 중인지 식별하는 데 도움이 됩니다.

**7단계: 저장하고 사용해보기**

서브에이전트를 저장합니다. 즉시 사용 가능합니다 (재시작 불필요). 사용해 보세요:

```
Use the code-improver agent to suggest improvements in this project
```

## 서브에이전트 구성

### /agents 명령 사용

`/agents` 명령은 서브에이전트를 관리하는 대화형 인터페이스를 제공합니다. `/agents`를 실행하면:

* 모든 사용 가능한 서브에이전트 보기 (내장, 사용자, 프로젝트, 플러그인)
* 가이드 설정 또는 Claude 생성으로 새 서브에이전트 만들기
* 기존 서브에이전트 구성 및 도구 접근 편집
* 커스텀 서브에이전트 삭제
* 중복이 있을 때 어떤 서브에이전트가 활성화되어 있는지 확인

### 서브에이전트 범위 선택

서브에이전트는 YAML frontmatter가 있는 Markdown 파일입니다. 범위에 따라 다른 위치에 저장합니다. 여러 서브에이전트가 동일한 이름을 공유하는 경우, 우선순위가 높은 위치가 승리합니다.

| 위치 | 범위 | 우선순위 | 만드는 방법 |
| :--- | :--- | :--- | :--- |
| `--agents` CLI 플래그 | 현재 세션 | 1 (최고) | Claude Code를 시작할 때 JSON 전달 |
| `.claude/agents/` | 현재 프로젝트 | 2 | 대화형 또는 수동 |
| `~/.claude/agents/` | 모든 프로젝트 | 3 | 대화형 또는 수동 |
| 플러그인의 `agents/` 디렉토리 | 플러그인이 활성화된 경우 | 4 (최저) | 플러그인과 함께 설치됨 |

**CLI로 정의된 서브에이전트**는 Claude Code를 시작할 때 JSON으로 전달됩니다. 해당 세션에만 존재하며 디스크에 저장되지 않습니다:

```bash
claude --agents '{
  "code-reviewer": {
    "description": "Expert code reviewer. Use proactively after code changes.",
    "prompt": "You are a senior code reviewer. Focus on code quality, security, and best practices.",
    "tools": ["Read", "Grep", "Glob", "Bash"],
    "model": "sonnet"
  }
}'
```

### 서브에이전트 파일 작성

서브에이전트 파일은 구성을 위해 YAML frontmatter를 사용하며, 그 다음에 Markdown의 시스템 프롬프트가 옵니다:

```markdown
---
name: code-reviewer
description: Reviews code for quality and best practices
tools: Read, Glob, Grep
model: sonnet
---

You are a code reviewer. When invoked, analyze the code and provide
specific, actionable feedback on quality, security, and best practices.
```

> 서브에이전트는 세션 시작 시 로드됩니다. 파일을 수동으로 추가하여 서브에이전트를 만드는 경우, 즉시 로드하려면 세션을 재시작하거나 `/agents`를 사용하세요.

#### 지원되는 frontmatter 필드

| 필드 | 필수 | 설명 |
| :--- | :--- | :--- |
| `name` | 예 | 소문자와 하이픈을 사용하는 고유 식별자 |
| `description` | 예 | Claude가 이 서브에이전트에게 위임해야 하는 경우 |
| `tools` | 아니요 | 서브에이전트가 사용할 수 있는 도구. 생략하면 모든 도구를 상속 |
| `disallowedTools` | 아니요 | 거부할 도구, 상속된 또는 지정된 목록에서 제거됨 |
| `model` | 아니요 | 사용할 모델: `sonnet`, `opus`, `haiku`, 또는 `inherit`. 기본값: `inherit` |
| `permissionMode` | 아니요 | 권한 모드: `default`, `acceptEdits`, `delegate`, `dontAsk`, `bypassPermissions`, 또는 `plan` |
| `maxTurns` | 아니요 | 서브에이전트가 중단하기 전 최대 에이전트 턴 수 |
| `skills` | 아니요 | 시작 시 서브에이전트의 컨텍스트에 로드할 스킬 |
| `mcpServers` | 아니요 | 이 서브에이전트에서 사용 가능한 MCP 서버 |
| `hooks` | 아니요 | 이 서브에이전트에 범위가 지정된 라이프사이클 hooks |
| `memory` | 아니요 | 영구 메모리 범위: `user`, `project`, 또는 `local` |

### 모델 선택

`model` 필드는 서브에이전트가 사용하는 AI 모델을 제어합니다:

* **모델 별칭**: `sonnet`, `opus`, 또는 `haiku` 중 하나를 사용
* **inherit**: 메인 대화와 동일한 모델 사용
* **생략**: 지정하지 않으면 기본값은 `inherit`

### 서브에이전트 기능 제어

#### 사용 가능한 도구

기본적으로 서브에이전트는 MCP 도구를 포함한 메인 대화의 모든 도구를 상속합니다.

도구를 제한하려면 `tools` 필드(허용 목록) 또는 `disallowedTools` 필드(거부 목록)를 사용합니다:

```yaml
---
name: safe-researcher
description: Research agent with restricted capabilities
tools: Read, Grep, Glob, Bash
disallowedTools: Write, Edit
---
```

#### 생성할 수 있는 서브에이전트 제한

에이전트가 `claude --agent`로 메인 스레드로 실행되면 Task 도구를 사용하여 서브에이전트를 생성할 수 있습니다. 생성할 수 있는 서브에이전트 유형을 제한하려면:

```yaml
---
name: coordinator
description: Coordinates work across specialized agents
tools: Task(worker, researcher), Read, Bash
---
```

제한 없이 어떤 서브에이전트도 생성할 수 있도록 허용하려면:

```yaml
tools: Task, Read, Bash
```

#### 권한 모드

| 모드 | 동작 |
| :--- | :--- |
| `default` | 프롬프트가 있는 표준 권한 검사 |
| `acceptEdits` | 파일 편집 자동 수락 |
| `dontAsk` | 권한 프롬프트 자동 거부 (명시적으로 허용된 도구는 여전히 작동) |
| `delegate` | 에이전트 팀 리더를 위한 조정 전용 모드 |
| `bypassPermissions` | 모든 권한 검사 건너뛰기 |
| `plan` | 플랜 모드 (읽기 전용 탐색) |

> `bypassPermissions`는 주의해서 사용하세요. 모든 권한 검사를 건너뜁니다.

#### 서브에이전트에 스킬 미리 로드

`skills` 필드를 사용하여 시작 시 서브에이전트의 컨텍스트에 스킬 콘텐츠를 주입합니다:

```yaml
---
name: api-developer
description: Implement API endpoints following team conventions
skills:
  - api-conventions
  - error-handling-patterns
---

Implement API endpoints. Follow the conventions and patterns from the preloaded skills.
```

#### 영구 메모리 활성화

`memory` 필드는 서브에이전트에게 대화 간에 유지되는 영구 디렉토리를 제공합니다:

```yaml
---
name: code-reviewer
description: Reviews code for quality and best practices
memory: user
---

You are a code reviewer. As you review code, update your agent memory with
patterns, conventions, and recurring issues you discover.
```

| 범위 | 위치 | 사용 시점 |
| :--- | :--- | :--- |
| `user` | `~/.claude/agent-memory/<name-of-agent>/` | 서브에이전트가 모든 프로젝트에서 학습 내용을 기억해야 할 때 |
| `project` | `.claude/agent-memory/<name-of-agent>/` | 서브에이전트의 지식이 프로젝트별이고 버전 컨트롤을 통해 공유 가능할 때 |
| `local` | `.claude/agent-memory-local/<name-of-agent>/` | 서브에이전트의 지식이 프로젝트별이지만 버전 컨트롤에 체크인하지 않아야 할 때 |

메모리가 활성화된 경우:

* 서브에이전트의 시스템 프롬프트에는 메모리 디렉토리를 읽고 쓰기 위한 지침이 포함됩니다.
* 서브에이전트의 시스템 프롬프트에는 메모리 디렉토리의 `MEMORY.md` 첫 200줄도 포함됩니다.
* Read, Write, Edit 도구가 자동으로 활성화되어 서브에이전트가 메모리 파일을 관리할 수 있습니다.

#### hooks를 사용한 조건부 규칙

도구 사용에 대한 더 동적인 제어를 위해 `PreToolUse` hooks를 사용하여 실행 전에 작업을 검증합니다:

```yaml
---
name: db-reader
description: Execute read-only database queries
tools: Bash
hooks:
  PreToolUse:
    - matcher: "Bash"
      hooks:
        - type: command
          command: "./scripts/validate-readonly-query.sh"
---
```

유효성 검사 스크립트는 hook JSON 입력을 읽고 쓰기 작업을 차단하기 위해 코드 2로 종료합니다:

```bash
#!/bin/bash
INPUT=$(cat)
COMMAND=$(echo "$INPUT" | jq -r '.tool_input.command // empty')

# SQL 쓰기 작업 차단 (대소문자 구분 없음)
if echo "$COMMAND" | grep -iE '\b(INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|TRUNCATE)\b' > /dev/null; then
  echo "Blocked: Only SELECT queries are allowed" >&2
  exit 2
fi

exit 0
```

#### 특정 서브에이전트 비활성화

설정의 `deny` 배열에 추가하여 Claude가 특정 서브에이전트를 사용하지 못하도록 할 수 있습니다:

```json
{
  "permissions": {
    "deny": ["Task(Explore)", "Task(my-custom-agent)"]
  }
}
```

`--disallowedTools` CLI 플래그를 사용할 수도 있습니다:

```bash
claude --disallowedTools "Task(Explore)"
```

### 서브에이전트에 대한 Hooks 정의

#### 서브에이전트 frontmatter의 Hooks

서브에이전트의 markdown 파일에 직접 hooks를 정의합니다. 이 hooks는 해당 특정 서브에이전트가 활성화되어 있는 동안에만 실행됩니다:

```yaml
---
name: code-reviewer
description: Review code changes with automatic linting
hooks:
  PreToolUse:
    - matcher: "Bash"
      hooks:
        - type: command
          command: "./scripts/validate-command.sh $TOOL_INPUT"
  PostToolUse:
    - matcher: "Edit|Write"
      hooks:
        - type: command
          command: "./scripts/run-linter.sh"
---
```

#### 서브에이전트 이벤트에 대한 프로젝트 수준 Hooks

서브에이전트 라이프사이클 이벤트에 응답하는 `settings.json`의 hooks를 구성합니다:

```json
{
  "hooks": {
    "SubagentStart": [
      {
        "matcher": "db-agent",
        "hooks": [
          { "type": "command", "command": "./scripts/setup-db-connection.sh" }
        ]
      }
    ],
    "SubagentStop": [
      {
        "hooks": [
          { "type": "command", "command": "./scripts/cleanup-db-connection.sh" }
        ]
      }
    ]
  }
}
```

## 서브에이전트 사용

### 자동 위임 이해

Claude는 요청의 작업 설명, 서브에이전트 구성의 `description` 필드, 현재 컨텍스트를 기반으로 작업을 자동으로 위임합니다. 적극적인 위임을 장려하려면 서브에이전트의 설명 필드에 "use proactively"와 같은 표현을 포함하세요.

특정 서브에이전트를 명시적으로 요청할 수도 있습니다:

```
Use the test-runner subagent to fix failing tests
Have the code-reviewer subagent look at my recent changes
```

### 포그라운드 또는 백그라운드에서 서브에이전트 실행

* **포그라운드 서브에이전트**는 완료될 때까지 메인 대화를 차단합니다.
* **백그라운드 서브에이전트**는 계속 작업하는 동안 동시에 실행됩니다.

백그라운드 서브에이전트가 권한 부족으로 실패하면 포그라운드에서 재개할 수 있습니다.

모든 백그라운드 작업 기능을 비활성화하려면 `CLAUDE_CODE_DISABLE_BACKGROUND_TASKS` 환경 변수를 `1`로 설정하세요.

### 일반적인 패턴

#### 대용량 작업 격리

테스트 실행, 문서 가져오기, 로그 파일 처리는 상당한 컨텍스트를 소비할 수 있습니다. 이를 서브에이전트에 위임하면 자세한 출력이 서브에이전트의 컨텍스트에 유지되고 관련 요약만 메인 대화로 반환됩니다.

```
Use a subagent to run the test suite and report only the failing tests with their error messages
```

#### 병렬 리서치 실행

독립적인 조사를 위해 여러 서브에이전트를 동시에 생성합니다:

```
Research the authentication, database, and API modules in parallel using separate subagents
```

> 서브에이전트가 완료되면 결과가 메인 대화로 반환됩니다. 각각 상세한 결과를 반환하는 많은 서브에이전트를 실행하면 상당한 컨텍스트를 소비할 수 있습니다.

#### 서브에이전트 체이닝

다단계 워크플로우의 경우 Claude에게 서브에이전트를 순서대로 사용하도록 요청합니다:

```
Use the code-reviewer subagent to find performance issues, then use the optimizer subagent to fix them
```

### 서브에이전트와 메인 대화 중 선택

**메인 대화**를 사용하는 경우:

* 작업에 자주 주고받는 것이나 반복적인 개선이 필요한 경우
* 여러 단계가 중요한 컨텍스트를 공유하는 경우
* 빠른 대상이 지정된 변경을 하는 경우
* 지연 시간이 중요한 경우. 서브에이전트는 새로 시작하므로 컨텍스트를 수집하는 데 시간이 필요할 수 있습니다

**서브에이전트**를 사용하는 경우:

* 작업이 메인 컨텍스트에 필요하지 않은 자세한 출력을 생성하는 경우
* 특정 도구 제한이나 권한을 적용하려는 경우
* 작업이 자체적으로 완결되어 요약을 반환할 수 있는 경우

### 서브에이전트 컨텍스트 관리

#### 서브에이전트 재개

각 서브에이전트 호출은 새로운 컨텍스트로 새 인스턴스를 만듭니다. 기존 서브에이전트의 작업을 계속하려면:

```
Use the code-reviewer subagent to review the authentication module
[에이전트 완료]

Continue that code review and now analyze the authorization logic
[Claude가 이전 대화의 전체 컨텍스트로 서브에이전트를 재개]
```

서브에이전트 트랜스크립트는 `~/.claude/projects/{project}/{sessionId}/subagents/`에 메인 대화와 독립적으로 유지됩니다.

#### 자동 압축

서브에이전트는 메인 대화와 동일한 로직을 사용하여 자동 압축을 지원합니다. 기본적으로 자동 압축은 약 95% 용량에서 트리거됩니다. 더 일찍 압축을 트리거하려면 `CLAUDE_AUTOCOMPACT_PCT_OVERRIDE`를 낮은 비율로 설정하세요.

## 서브에이전트 예시

### 코드 리뷰어

```markdown
---
name: code-reviewer
description: Expert code review specialist. Proactively reviews code for quality, security, and maintainability. Use immediately after writing or modifying code.
tools: Read, Grep, Glob, Bash
model: inherit
---

You are a senior code reviewer ensuring high standards of code quality and security.

When invoked:
1. Run git diff to see recent changes
2. Focus on modified files
3. Begin review immediately

Review checklist:
- Code is clear and readable
- Functions and variables are well-named
- No duplicated code
- Proper error handling
- No exposed secrets or API keys
- Input validation implemented
- Good test coverage
- Performance considerations addressed

Provide feedback organized by priority:
- Critical issues (must fix)
- Warnings (should fix)
- Suggestions (consider improving)

Include specific examples of how to fix issues.
```

### 디버거

```markdown
---
name: debugger
description: Debugging specialist for errors, test failures, and unexpected behavior. Use proactively when encountering any issues.
tools: Read, Edit, Bash, Grep, Glob
---

You are an expert debugger specializing in root cause analysis.

When invoked:
1. Capture error message and stack trace
2. Identify reproduction steps
3. Isolate the failure location
4. Implement minimal fix
5. Verify solution works

Debugging process:
- Analyze error messages and logs
- Check recent code changes
- Form and test hypotheses
- Add strategic debug logging
- Inspect variable states

For each issue, provide:
- Root cause explanation
- Evidence supporting the diagnosis
- Specific code fix
- Testing approach
- Prevention recommendations
```

### 데이터 과학자

```markdown
---
name: data-scientist
description: Data analysis expert for SQL queries, BigQuery operations, and data insights. Use proactively for data analysis tasks and queries.
tools: Bash, Read, Write
model: sonnet
---

You are a data scientist specializing in SQL and BigQuery analysis.

When invoked:
1. Understand the data analysis requirement
2. Write efficient SQL queries
3. Use BigQuery command line tools (bq) when appropriate
4. Analyze and summarize results
5. Present findings clearly
```

### 데이터베이스 쿼리 유효성 검사기

```markdown
---
name: db-reader
description: Execute read-only database queries. Use when analyzing data or generating reports.
tools: Bash
hooks:
  PreToolUse:
    - matcher: "Bash"
      hooks:
        - type: command
          command: "./scripts/validate-readonly-query.sh"
---

You are a database analyst with read-only access. Execute SELECT queries to answer questions about the data.

When asked to analyze data:
1. Identify which tables contain the relevant data
2. Write efficient SELECT queries with appropriate filters
3. Present results clearly with context

You cannot modify data. If asked to INSERT, UPDATE, DELETE, or modify schema, explain that you only have read access.
```

유효성 검사 스크립트 만들기:

```bash
#!/bin/bash
# SQL 쓰기 작업을 차단하고 SELECT 쿼리를 허용합니다

INPUT=$(cat)
COMMAND=$(echo "$INPUT" | jq -r '.tool_input.command // empty')

if [ -z "$COMMAND" ]; then
  exit 0
fi

# 쓰기 작업 차단 (대소문자 구분 없음)
if echo "$COMMAND" | grep -iE '\b(INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|TRUNCATE|REPLACE|MERGE)\b' > /dev/null; then
  echo "Blocked: Write operations not allowed. Use SELECT queries only." >&2
  exit 2
fi

exit 0
```

스크립트를 실행 가능하게 만들기:

```bash
chmod +x ./scripts/validate-readonly-query.sh
```

## 다음 단계

* 팀이나 프로젝트에서 서브에이전트를 공유하기 위해 플러그인으로 서브에이전트 배포
* CI/CD 및 자동화를 위해 Agent SDK로 Claude Code 프로그래밍 방식으로 실행
* 서브에이전트에게 외부 도구와 데이터에 대한 접근을 제공하기 위해 MCP 서버 사용
